{% extends "base.html" %}

{% block title %}Dashboard - DeskPulse{% endblock %}

{% block content %}
<!-- Header: Project branding and tagline -->
<header>
    <hgroup>
        <h1>DeskPulse</h1>
        <h2>Privacy-First Posture Monitoring</h2>
    </hgroup>
</header>

<!-- Main article: Live camera feed and posture status -->
<article>
    <header>
        <h3>
            <span class="status-indicator status-offline" id="status-dot"></span>
            <span id="status-text">Connecting to camera...</span>
        </h3>
    </header>

    <!-- Live camera feed (placeholder until Story 2.6 SocketIO) -->
    <div class="camera-feed">
        <img id="camera-frame"
             alt="Live camera feed with pose overlay"
             class="hidden">
        <p class="placeholder-text" id="camera-placeholder">
            üìπ Waiting for camera feed...<br>
            <small>(Camera feed will appear when CV pipeline is running)</small>
        </p>
    </div>

    <footer>
        <p id="posture-message">Your posture status will appear here when detected.</p>
        <p class="recording-indicator">
            <span class="recording-dot"></span>
            Recording: Camera is active
        </p>
    </footer>
</article>

<!-- Today's stats summary (placeholder until Epic 4) -->
<article>
    <header><h3>Today's Summary</h3></header>
    <div role="group">
        <div>
            <strong>Good Posture:</strong> <span id="good-time">--h --m</span>
        </div>
        <div>
            <strong>Bad Posture:</strong> <span id="bad-time">--h --m</span>
        </div>
        <div>
            <strong>Posture Score:</strong> <span id="posture-score">--%</span>
        </div>
    </div>
    <footer>
        <small>Stats load immediately on page load and update automatically every 30 seconds</small>
    </footer>
</article>

<!-- Story 4.4: 7-Day Historical Data Table -->
<article>
    <header><h3>7-Day History</h3></header>
    <div id="history-table-container">
        <!-- Loading placeholder shown before JavaScript loads data -->
        <p style="text-align: center; padding: 2rem; color: #6b7280;">
            Loading history...
        </p>
    </div>
    <footer>
        <small>Trend indicators show day-over-day score changes (‚Üë improving, ‚Üí stable, ‚Üì declining)</small>
    </footer>
</article>

<!-- Privacy controls (Story 3.4) -->
<article>
    <header><h3>Privacy Controls</h3></header>
    <button id="pause-btn" class="secondary">‚è∏ Pause Monitoring</button>
    <button id="resume-btn" class="primary" style="display: none;">‚ñ∂Ô∏è Resume Monitoring</button>
    <footer>
        <small>
            Pause monitoring during video calls or breaks for privacy<br>
            Camera feed continues (transparency) while monitoring paused
        </small>
    </footer>
</article>

<!-- System status (health check indicator) -->
<article>
    <header><h3>System Status</h3></header>
    <p>
        <strong>CV Pipeline:</strong> <span id="cv-status">Checking...</span><br>
        <strong>Last Update:</strong> <span id="last-update">--:--:--</span>
    </p>
</article>

<!-- Network Settings -->
<article>
    <header><h3>Network Settings</h3></header>
    <label>
        <input type="checkbox" id="network-access-toggle" role="switch">
        Enable Network Access (Allow remote dashboard access)
    </label>
    <footer>
        <small id="network-status">
            Current: <span id="current-host">Checking...</span><br>
            <em>Changes require app restart to take effect</em>
        </small>
    </footer>
</article>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
